# 02. Анализ эффективности менеджеров по продажам

Этот воркфлоу автоматизирует сбор и анализ данных для оценки производительности менеджеров по продажам. Он извлекает информацию о лидах и заказах из Airtable, рассчитывает ключевые показатели и обновляет итоговую статистику.

## Описание

Основная задача — выявить наиболее и наименее эффективных сотрудников на основе объективных данных. Воркфлоу выполняет следующие шаги:
-   **Сбор данных**: Загружает записи о лидах и заказах из двух разных таблиц в Airtable.
-   **Обогащение данных**: Сопоставляет заказы с лидами, чтобы связать каждую продажу с конкретным менеджером.
-   **Расчет KPI**: Агрегирует данные по каждому менеджеру для вычисления:
    -   Общей суммы продаж.
    -   Количества обработанных лидов.
    -   Конверсии из лида в продажу.
-   **Принятие решений**: На основе заданных порогов (например, самая низкая конверсия и сумма продаж) помечает менеджера как кандидата на увольнение.
-   **Обновление статистики**: Записывает рассчитанные показатели в отдельную таблицу `ManagerStats` в Airtable для дальнейшего анализа руководством.

## Ключевые компоненты

-   **Airtable Trigger**: Запускает воркфлоу при появлении новых записей (например, новых лидов).
-   **Airtable Node**: Используется для поиска и обновления записей в базах данных.
-   **Merge Node**: Объединяет данные о лидах и заказах по общему ключу (например, email).
-   **Code Node**: Выполняет кастомные вычисления, такие как расчет конверсии и агрегация сумм.
-   **IF/Switch Nodes**: Используются для фильтрации данных и реализации логических ветвлений (например, для маркировки неэффективных сотрудников).

## Настройка и запуск

1.  **Импорт**: Загрузите файл `workflow.json` в ваш n8n.
2.  **Настройка Airtable**:
    -   Во всех нодах, связанных с Airtable (`Airtable Trigger`, `Airtable Node`), укажите ваши учетные данные (API-ключ).
    -   Убедитесь, что ID базы (`Base ID`) и таблиц (`Table ID`) соответствуют вашей структуре в Airtable.
3.  **Настройка логики**:
    -   В узле `Code` (или `IF`), отвечающем за маркировку, при необходимости скорректируйте пороги для определения неэффективности (например, минимально допустимая конверсия).
4.  **Активация**: Включите воркфлоу. Он будет автоматически запускаться по триггеру или по расписанию (в зависимости от конфигурации).
